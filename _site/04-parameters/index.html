















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2020-06-09 11:46:46 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="../assets/favicons//apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/favicons//apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/favicons//apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/favicons//apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="../assets/favicons//apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="../assets/favicons//apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="../assets/favicons//apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../assets/favicons//apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="../assets/favicons//favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="../assets/favicons//favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="../assets/favicons//favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="../assets/favicons//favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="../assets/favicons//favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="../assets/favicons//mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="../assets/favicons//mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="../assets/favicons//mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="../assets/favicons//mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="../assets/favicons//mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Parameterising your ligands &ndash; Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools
  </title>  

  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      

      
      <a class="navbar-brand" href="../">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-overview/index.html">Overview of AmberTools20</a></li>
            
            <li><a href="../02-setup/index.html">Log in and environment set up in ARCHER</a></li>
            
            <li><a href="../03-prepPDB/index.html">Preparing your PDB file</a></li>
            
            <li><a href="../04-parameters/index.html">Parameterising your ligands</a></li>
            
            <li><a href="../05-leap/index.html">System set up</a></li>
            
            <li><a href="../06-minimisation/index.html">Energy minimisation</a></li>
            
            <li><a href="../07-therm/index.html">Thermalisation and Density equilibration</a></li>
            
            <li><a href="../08-parmed/index.html">Adding missing LJ parameters and recentering coordinates</a></li>
            
            <li><a href="../09-qmmm/index.html">QM/MM monitorisation runs</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
            <li><a href="../amber/index.html">Amber Input Files</a></li>
            
            <li><a href="../cp2k/index.html">CP2K Input Files</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit//_episodes/04-parameters.md" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>

















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-prepPDB/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-leap/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Parameterising your ligands</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 15 min
      <br/>
      <strong>Exercises:</strong> 0 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>How do I generate parameters for non-conventional residues?</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Generate parameters for GWS ligand using <code class="language-plaintext highlighter-rouge">antechamber</code> and <code class="language-plaintext highlighter-rouge">parmchk2</code>.</p>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<p>In this tutorial, we will make use of the <code class="language-plaintext highlighter-rouge">antechamber</code> and <code class="language-plaintext highlighter-rouge">parmchk2</code> tools from AmberTools package to generate AMBER force field parameters. We will use the “<strong>general AMBER force field 2 <a href="http://ambermd.org/antechamber/gaff.html">(GAFF2)</a></strong>” parameters. This force field was designed to provide atom types and atom parameters needed to parameterise most pharmaceutical molecules, and is compatible with the traditional AMBER force fields for proteins. To assign partial charges, we are going to use <strong><a href="https://pubmed.ncbi.nlm.nih.gov/12395429/">AM1-BCC2 charge method</a></strong>. It is an inexpensive and fast method for calculating partial charges and be we don’t need to worry too much about its limitations as partial charges won’t be used during production runs due to the QM treatment of the ligand in the QM/MM simulation.</p>

<hr />

<h2 id="generating-point-charges-and-assigning-atomtypes-with-antechamber">Generating point charges and assigning atomtypes with <code class="language-plaintext highlighter-rouge">antechamber</code></h2>

<p><code class="language-plaintext highlighter-rouge">antechamber</code> allows the rapid generation of topology files for use with the AMBER simulation programs. It is a higher-level wrapper around other AmberTools programs (<code class="language-plaintext highlighter-rouge">sqm</code>, <code class="language-plaintext highlighter-rouge">divcon</code>, <code class="language-plaintext highlighter-rouge">atomtype</code>, <code class="language-plaintext highlighter-rouge">am1bcc</code>, <code class="language-plaintext highlighter-rouge">bondtype</code>, <code class="language-plaintext highlighter-rouge">espgen</code>, <code class="language-plaintext highlighter-rouge">respgen</code> and <code class="language-plaintext highlighter-rouge">prepgen</code>) and is able to:</p>

<ul>
  <li>Automatically identify bond and atom types</li>
  <li>Judge atomic equivalence</li>
  <li>Generate residue topology files</li>
  <li>Find missing force field parameters and supply reasonable suggestions</li>
</ul>

<p>We will use <code class="language-plaintext highlighter-rouge">antechamber</code> to assign atom types to the GWS ligand and calculate a set of point charges. We will have to specify GAFF2 force field (<code class="language-plaintext highlighter-rouge">-at gaff2</code>, more information on the parameters here: <code class="language-plaintext highlighter-rouge">$AMBERHOME/dat/leap/parm/gaff2.dat</code>), the <a href="https://pubmed.ncbi.nlm.nih.gov/12395429/">AM1-BCC2</a> charge method (<code class="language-plaintext highlighter-rouge">-c bcc</code>), the net charge of the molecule (<code class="language-plaintext highlighter-rouge">-nc 0</code>) and the name of the new residue generated (We are going to keep GWS: <code class="language-plaintext highlighter-rouge">-rn GWS</code>). We are going to output a mol2-type file (<code class="language-plaintext highlighter-rouge">-fo mol2</code>) containing the atomtypes and the point charges.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>antechamber <span class="nt">-i</span> GWS.H.pdb <span class="nt">-fi</span> pdb <span class="nt">-o</span> GWS.mol2 <span class="nt">-fo</span> mol2 <span class="nt">-c</span> bcc <span class="nt">-nc</span> 0 <span class="nt">-rn</span> GWS <span class="nt">-at</span> gaff2
</code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Welcome to antechamber 20.0: molecular input file processor.

acdoctor mode is on: check and diagnosis problems in the input file.
-- Check Format for pdb File --
   Status: pass
-- Check Unusual Elements --
   Status: pass
-- Check Open Valences --
   Status: pass
-- Check Geometry --
      for those bonded   
      for those not bonded   
   Status: pass
-- Check Weird Bonds --
   Status: pass
-- Check Number of Units --
   Status: pass
acdoctor mode has completed checking the input file.

Info: Total number of electrons: 118; net charge: 0

Running: /home/d118/d118/shared/amber20/bin/sqm -O -i sqm.in -o sqm.out
</code></pre></div></div>

<p>This step generates a lot of intermediate files (in capital letters). You can safely delete them as these are used in antechamber and we no longer require them. The <code class="language-plaintext highlighter-rouge">sqm.xxx</code> files are input and output from the <code class="language-plaintext highlighter-rouge">sqm</code> quantum mechanics code used by <code class="language-plaintext highlighter-rouge">antechamber</code> to calculate the atomic point charges. We are not interested in the data here except to check that the sqm calculation completed successfully.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">tail  </span>sqm.out
</code></pre></div></div>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>           --------- Calculation Completed ----------
</code></pre></div></div>

<p>Once we are sure that the point charges were generated The MOL2 file contains tridimensional information of the molecule as well as atom type and point charges. You can find more information on the MOL2 format <a href="http://chemyang.ccnu.edu.cn/ccb/server/AIMMS/mol2.pdf">here</a>. The resulting MOL2 file is shown below:</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;TRIPOS&gt;MOLECULE
GWS 
   34    35     1     0     0
SMALL
bcc


@&lt;TRIPOS&gt;ATOM
      1 N1           7.5340     0.3440    17.5810 nb      1001 GWS      -0.643000
      2 C4          13.4880    -0.5140    24.0620 c3      1001 GWS      -0.075900
      3 C5          13.9760    -1.6820    23.2210 c3      1001 GWS      -0.078400
                                       ...
</code></pre></div></div>

<blockquote class="callout">
  <h2 id="tip">TIP</h2>

  <p>The GAFF and GAFF2 atom types are in lower case. This is the mechanism by which the GAFF force field is kept independent from the macromolecular AMBER force fields. All of the traditional AMBER force fields use uppercase atom types. In this way the GAFF and traditional force fields can be mixed in the same calculation.</p>
</blockquote>

<hr />

<h2 id="looking-for-missing-force-field-parameters-with-parmchk2">Looking for missing force field parameters with <code class="language-plaintext highlighter-rouge">parmchk2</code></h2>

<p>While the most likely combinations of bond, angle and dihedral parameters are defined in the parameter file it is possible that our molecule might contain combinations of atom types for bonds, angles or dihedrals that have not been parameterised. If this is the case, we will have to specify any missing parameters before we can create our prmtop and inpcrd files in LEap.</p>

<p>We will use <code class="language-plaintext highlighter-rouge">parmchk2</code> to test if all the parameters we require are available.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>parmchk2 <span class="nt">-i</span> GWS.mol2 <span class="nt">-f</span> mol2 <span class="nt">-o</span> GWS.frcmod <span class="nt">-s</span> gaff2
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">parmchk2</code> generates a parameter file that can be loaded into Leap in order to add missing parameters. It contains all of the missing parameters. If possible, it will fill in these missing parameters by analogy to a similar parameter. Let’s look at the generated GWS.frcmod file:</p>

<div class="language-plaintext output highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Remark line goes here
MASS

BOND
ca-ns  315.20   1.412       same as ca- n, penalty score=  0.0
c -ns  356.20   1.379       same as  c- n, penalty score=  0.0
hn-ns  527.30   1.013       same as hn- n, penalty score=  0.0

ANGLE
c -ns-ca   65.700     123.710   same as c -n -ca, penalty score=  0.0
ca-ns-hn   48.000     116.000   same as ca-n -hn, penalty score=  0.0
ns-c -o   113.800     123.050   same as n -c -o , penalty score=  0.0
c -ns-hn   48.700     117.550   same as c -n -hn, penalty score=  0.0
ca-ca-ns   85.600     120.190   same as ca-ca-n , penalty score=  0.0
c3-c -ns   84.300     115.180   same as c3-c -n , penalty score=  0.0

DIHE
o -c -ns-ca   4   10.000       180.000           2.000      same as X -c -n -X , penalty score=  0.0
c3-c -ns-ca   1    0.750       180.000          -2.000      same as c3-c -n -ca
c3-c -ns-ca   1    0.500         0.000           3.000      same as c3-c -n -ca, penalty score=  0.0
o -c -ns-hn   1    2.500       180.000          -2.000      same as hn-n -c -o
o -c -ns-hn   1    2.000         0.000           1.000      same as hn-n -c -o , penalty score=  0.0
ca-ca-ns-c    1    0.950       180.000           2.000      same as c -n -ca-ca, penalty score=  0.0
ns-c -c3-c3   1    0.000       180.000          -4.000      same as n -c -c3-c3
ns-c -c3-c3   1    0.710       180.000           2.000      same as n -c -c3-c3, penalty score=  0.0
ca-ca-ns-hn   4    1.800       180.000           2.000      same as X -ca-n -X , penalty score=  0.0
c3-c -ns-hn   4   10.000       180.000           2.000      same as X -c -n -X , penalty score=  0.0

IMPROPER
ca-ca-ca-ns         1.1          180.0         2.0          Using the default value
ca-ca-ca-ha         1.1          180.0         2.0          Using general improper torsional angle  X- X-ca-ha, penalty score=  6.0)
c3-ns-c -o         10.5          180.0         2.0          Using general improper torsional angle  X- X- c- o, penalty score=  6.0)
c -ca-ns-hn         1.1          180.0         2.0          Same as X -X -n -hn, penalty score=  6.0 (use general term))
ca-h4-ca-nb         1.1          180.0         2.0          Same as X -X -ca-ha, penalty score= 44.3 (use general term))

NONBON

</code></pre></div></div>

<blockquote class="callout">
  <h2 id="tip-1">TIP</h2>

  <p>You should check these parameters carefully before running a simulation. If antechamber can’t empirically calculate a value or has no analogy it will either add a default value that it thinks is reasonable or alternatively insert a place holder (with zeros everywhere) and the comment “<strong>ATTN: needs revision</strong>”. In this case you will have to manually parameterise this yourself. See the links at the beginning of the section.</p>
</blockquote>

<hr />

<blockquote class="challenge">
  <h2 id="further-information">FURTHER INFORMATION:</h2>

  <p>This step is not trivial and there are many ways to do it. In this example, as we are aiming to use a QM description of the ligand, we can use a simple approach. If you have trouble parameterising your ligands here are some useful links:</p>

  <ul>
    <li><a href="https://ambermd.org/tutorials/basic/tutorial4/index.htm">AMBER tutorial on simple ligand parameterisation</a></li>
    <li><a href="https://ambermd.org/tutorials/advanced/tutorial1/section1.htm">AMBER tutorial on advanced ligand parameterisation</a></li>
    <li><a href="http://www.ub.edu/cbdd/?q=content/small-molecule-dihedrals-parametrization">Parameterisation of dihedral angles</a></li>
    <li><a href="http://research.bmh.manchester.ac.uk/bryce/amber/">AMBER parameter database</a></li>
    <li><a href="http://ambermd.org/tutorials/advanced/tutorial23/">Paramfit tutorial</a></li>
  </ul>

</blockquote>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>Generating parameters for non-conventinal residues is not easy and there are different ways to parameterise them.</p>
</li>
    
    <li><p>The quality of the parameters is important to obtain valid results.</p>
</li>
    
    <li><p><code class="language-plaintext highlighter-rouge">antechamber</code> creates parameters for a non-conventional residues.</p>
</li>
    
    <li><p><code class="language-plaintext highlighter-rouge">parmchk2</code> checks for missing parameters in the forcefield.</p>
</li>
    
    <li><p>ALWAYS check the parameters for your system and test that they behave as expected.</p>
</li>
    
  </ul>
</blockquote>

</article>
















<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-prepPDB/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-leap/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      






<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit//_episodes/04-parameters.md" data-checker-ignore>Edit on GitHub</a>
	
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:s.llabres@epcc.ed.ac.uk">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
