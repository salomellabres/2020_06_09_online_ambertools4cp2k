















<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2020-06-09 11:46:46 +0100">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="./assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="./assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="./assets/favicons//apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="./assets/favicons//apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="./assets/favicons//apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./assets/favicons//apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="./assets/favicons//apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="./assets/favicons//apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="./assets/favicons//apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="./assets/favicons//apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="./assets/favicons//favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="./assets/favicons//favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="./assets/favicons//favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="./assets/favicons//favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="./assets/favicons//favicon-128.png" sizes="128x128" />
    <meta name="application-name" content=" - Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="./assets/favicons//mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="./assets/favicons//mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="./assets/favicons//mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="./assets/favicons//mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="./assets/favicons//mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->

  <title>
  Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools
  </title>  

  </head>
  <body>

    



    <div class="container">
      






<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      

      
      <a class="navbar-brand" href="./">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="./CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="./setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="./" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="./01-overview/index.html">Overview of AmberTools20</a></li>
            
            <li><a href="./02-setup/index.html">Log in and environment set up in ARCHER</a></li>
            
            <li><a href="./03-prepPDB/index.html">Preparing your PDB file</a></li>
            
            <li><a href="./04-parameters/index.html">Parameterising your ligands</a></li>
            
            <li><a href="./05-leap/index.html">System set up</a></li>
            
            <li><a href="./06-minimisation/index.html">Energy minimisation</a></li>
            
            <li><a href="./07-therm/index.html">Thermalisation and Density equilibration</a></li>
            
            <li><a href="./08-parmed/index.html">Adding missing LJ parameters and recentering coordinates</a></li>
            
            <li><a href="./09-qmmm/index.html">QM/MM monitorisation runs</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="./aio.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="./" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="./reference.html">Reference</a></li>
            
            <li><a href="./amber/index.html">Amber Input Files</a></li>
            
            <li><a href="./cp2k/index.html">CP2K Input Files</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="./LICENSE.html">License</a></li>
	
	<li><a href="/edit//reference.md" data-checker-ignore>Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>















<h1 class="maintitle"><a href="./">Preparing to run biomolecular QM/MM simulations with CP2K using AmberTools</a></h1>

<article>














<h2>Key Points</h2>
<table class="table table-striped">

  
    <tr>
      <td class="col-md-3">
        <a href="./01-overview/index.html">Overview of AmberTools20</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>AmberTools package has multiple tools to prepare, simulate and analyse biological systems.</p>
</li>
        
        <li><p>You should familiarise yourself with <code class="language-plaintext highlighter-rouge">tleap</code>, <code class="language-plaintext highlighter-rouge">pamred</code>, <code class="language-plaintext highlighter-rouge">nab</code>, <code class="language-plaintext highlighter-rouge">cpptraj</code>, <code class="language-plaintext highlighter-rouge">antechamber</code>, <code class="language-plaintext highlighter-rouge">parmch2</code> and <code class="language-plaintext highlighter-rouge">sander</code> as they will ususally be helpful to set up a biological system.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">tleap</code> is used to generate topologies and coordinates for biological molecules.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">cpptraj</code> is used to postprocess and analyse AMBER trajectories.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">antechamber</code> is used to create parameters for non-standard aminoacids and drug-like molecules.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">sander</code> runs molecular dynamics simulations</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">parmed</code> allows modifying AMBER topologies</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./02-setup/index.html">Log in and environment set up in ARCHER</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>SSH to ARCHER</p>
</li>
        
        <li><p>Load Ambertools with <code class="language-plaintext highlighter-rouge">module load</code>.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./03-prepPDB/index.html">Preparing your PDB file</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p><code class="language-plaintext highlighter-rouge">pdb4amber</code> does a preliminary check on your PDB file and cleans potential errors in the protein structure.</p>
</li>
        
        <li><p>ALWAYS assess the protonation state of your system at the pH of interest.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">PROPKA</code> and <code class="language-plaintext highlighter-rouge">H++ server</code> predict the protonation state of each aminoacid of protein.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">openbabel</code> is a chemical toolbox designed to search, convert, analyze, or store data from molecular modeling, chemistry, biochemistry, or related areas.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./04-parameters/index.html">Parameterising your ligands</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>Generating parameters for non-conventinal residues is not easy and there are different ways to parameterise them.</p>
</li>
        
        <li><p>The quality of the parameters is important to obtain valid results.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">antechamber</code> creates parameters for a non-conventional residues.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">parmchk2</code> checks for missing parameters in the forcefield.</p>
</li>
        
        <li><p>ALWAYS check the parameters for your system and test that they behave as expected.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./05-leap/index.html">System set up</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>LEap creates topologies and initial coordinates in AMBER format.</p>
</li>
        
        <li><p>LEap can generate initial coordinates from scratch if needed.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">xLEap</code> (with GUI) and <code class="language-plaintext highlighter-rouge">tLEap</code> (through the terminal) are the two flavours of LEap.</p>
</li>
        
        <li><p>Your MM system should always be neutral, add counterions to neutralise your system.</p>
</li>
        
        <li><p>ALWAYS visualise and check the structures created by LEap.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./06-minimisation/index.html">Energy minimisation</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>After adding water molecules and combining coordinates of different system elements we have to minimise the system to fix any bad contacts (LEap had warned us already of some bad contacts in the structure).</p>
</li>
        
        <li><p>Removing bad contacts at this point will prevent our system from failing catastrophically later down the line.</p>
</li>
        
        <li><p>Combining different minimisation methods is a good practice and can help to avoid getting stuck into a local minima.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./07-therm/index.html">Thermalisation and Density equilibration</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>Thermalisation takes our system up to the target temperature.</p>
</li>
        
        <li><p>Using a temperature ramp is a good way to slowly increase the system temperature and avoid your system from blowing up due to some bad contacts in your coordinates. You can set up a temperature ramp using the NMR restraint options of <code class="language-plaintext highlighter-rouge">sander</code>.</p>
</li>
        
        <li><p>Density equilibration fixes the water density and corrects the size simulation box. It prevents air bubbles in our system that might cause simulation artefacts.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./08-parmed/index.html">Adding missing LJ parameters and recentering coordinates</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>In the MM forcefields, hydrogen atoms do not have Lennard-Jones parameters.</p>
</li>
        
        <li><p>Adding missing Lennard-Jones parameters to the topology will prevent having unphysical interactions int the QM/MM boundary.</p>
</li>
        
        <li><p>You can modify amber topologies using <code class="language-plaintext highlighter-rouge">parmed</code>.</p>
</li>
        
        <li><p>You should recenter the system to avoid having a split QM region in the QM/MM.</p>
</li>
        
        <li><p><code class="language-plaintext highlighter-rouge">cpptraj</code> is the main analysis and postprocess trajectory tool for Amber.</p>
</li>
        
        <li><p>Using <code class="language-plaintext highlighter-rouge">autoimage</code> in <code class="language-plaintext highlighter-rouge">cpptraj</code> recenters the solute and fixes most of the PBC problems of the simulation.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

  
    <tr>
      <td class="col-md-3">
        <a href="./09-qmmm/index.html">QM/MM monitorisation runs</a>
      </td>
      <td class="col-md-9">
        <ul>
        
        <li><p>Choosing the QM region is in not trivial.</p>
</li>
        
        <li><p>You should also equilibrate the system using QM/MM ensemble before running your QM/MM production runs.</p>
</li>
        
        <li><p>Instabilities between the QM and the MM regions are likely to show up in this monitorisation run.</p>
</li>
        
        </ul>
      </td>
    </tr>
  

</table>

<hr />

<h2 id="ambertools-and-amber-links-for-quick-reference">AmberTools and Amber links for Quick Reference</h2>

<ul>
  <li>For more information on <a href="http://ambermd.org/AmberTools.php">AmberTools</a> look into its main page.</li>
  <li>Amber and Ambertools documentation can be found <a href="http://ambermd.org/MailingLists.php">here</a>.
    <ul>
      <li><code class="language-plaintext highlighter-rouge">parmed</code> documentation: http://parmed.github.io/ParmEd/html/index.html</li>
      <li><code class="language-plaintext highlighter-rouge">cpptraj</code> documentation: https://amber-md.github.io/cpptraj/CPPTRAJ.xhtml</li>
    </ul>
  </li>
  <li>Amber has developed many tutorials that can be helpful to your simulations. Please check <a href="http://ambermd.org/tutorials/">AmberMD tutorials</a> webpage for more information on the system set up. We found specially helpful:
    <ul>
      <li><a href="http://ambermd.org/tutorials/pengfei/index.php">Fundamentals of LEap</a>.</li>
      <li><a href="http://ambermd.org/tutorials/basic/tutorial0/index.htm">An Introduction to Molecular Dynamics Simulations using AMBER</a></li>
      <li><a href="http://ambermd.org/tutorials/basic/tutorial1/index.htm">Simulating a small fragment of DNA</a></li>
      <li><a href="http://www.charmm-gui.org/?doc=demo&amp;id=amber_ff&amp;lesson=3">Changing Protonation State with PDB2PQR and reading AMBER FF residue names (6IYC)</a></li>
      <li><a href="http://ambermd.org/tutorials/AdvancedSetup.php">Creating Special Systems for Molecular Simulations</a></li>
      <li><a href="http://ambermd.org/tutorials/ForceField.php">Extending the Amber Force Field</a></li>
    </ul>
  </li>
  <li>Amber community is usually receptive and helpful if you have a problem. Do not hesitate to use the <a href="http://ambermd.org/MailingLists.php">Amber Mailing lists</a>.</li>
  <li>More information of <a href="https://ambermd.org/AmberModels.php">Amber forcefields</a>.</li>
</ul>

<h2 id="cp2k-links-for-quick-reference">CP2K links for Quick Reference</h2>

<ul>
  <li>For more information on <a href="https://www.cp2k.org">CP2K</a> look into its webpage.</li>
  <li>CP2K documentation can be found <a href="https://manual.cp2k.org/#gsc.tab=0">here</a></li>
  <li><a href="https://www.cp2k.org/howto">CP2K tutorials</a>.</li>
</ul>



</article>

      
      






<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit//reference.md" data-checker-ignore>Edit on GitHub</a>
	
	/
	<a href="/blob//CONTRIBUTING.md" data-checker-ignore>Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob//CITATION" data-checker-ignore>Cite</a>
	/
	<a href="mailto:s.llabres@epcc.ed.ac.uk">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="./assets/js/jquery.min.js"></script>
<script src="./assets/js/bootstrap.min.js"></script>
<script src="./assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
